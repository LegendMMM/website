<!doctype html>
<html lang="zh-Hant">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>訂單管理 | 環球影城海報冊代購</title>
    <link rel="stylesheet" href="./assets/styles.css?v=editorial-20260212-3" />
  </head>
  <body class="admin-page" data-admin-page="orders">
    <header class="site-header">
      <div class="container">
        <h1>訂單管理</h1>
        <p>編輯整筆訂單內容，自由切換狀態，進階篩選可收合。</p>
      </div>
    </header>

    <main class="container admin-layout">
      <section class="card" id="auth-panel">
        <h2>管理者登入</h2>
        <form id="login-form" class="stack">
          <label>
            帳號 (Email)
            <input id="admin-email" type="email" required />
          </label>
          <label>
            密碼
            <input id="admin-password" type="password" required minlength="6" />
          </label>
          <button type="submit">登入</button>
          <p id="auth-message" class="message" aria-live="polite"></p>
        </form>
      </section>

      <section class="card hidden" id="admin-panel">
        <div class="admin-shell-head">
          <div>
            <h2>訂單與狀態紀錄</h2>
            <p class="hint">狀態下拉由活動設定或全域設定帶入。</p>
          </div>
          <button data-action="logout" type="button">登出</button>
        </div>

        <nav class="admin-nav">
          <a href="./admin.html">管理首頁</a>
          <a href="./admin-campaigns.html">活動管理</a>
          <a href="./admin-orders.html" class="current">訂單管理</a>
          <a href="./admin-settings.html">系統設定</a>
        </nav>

        <div class="subnav-tabs section-divider">
          <button type="button" class="tab-btn active" data-orders-view="list">訂單列表</button>
          <button type="button" class="tab-btn" data-orders-view="logs">狀態紀錄</button>
        </div>

        <section id="orders-list-view" class="stack">
          <div class="orders-main-toolbar">
            <label class="orders-main-toolbar__field">
              選擇活動
              <select id="orders-campaign-filter"></select>
            </label>
            <div class="orders-main-toolbar__actions">
              <button id="reload-orders-btn" type="button">重新整理</button>
              <button id="export-csv-btn" type="button">匯出 CSV</button>
            </div>
          </div>

          <section class="compact-card orders-quick-card">
            <div class="orders-quick-head">
              <h3>快速篩選</h3>
              <p class="hint">先用快捷鍵，進階條件再展開設定。</p>
            </div>
            <div class="quick-filter-row">
              <button type="button" class="tab-btn" data-quick-filter="all">全部</button>
              <button type="button" class="tab-btn" data-quick-filter="unfinished">未完成</button>
              <button type="button" class="tab-btn" data-quick-filter="unconfirmed">未確認</button>
              <button type="button" class="tab-btn" data-quick-filter="created_today">今日新單</button>
            </div>
          </section>

          <section class="compact-card orders-stats-card">
            <div class="orders-stats-head">
              <h3>訂單統計</h3>
              <p class="hint">依目前活動與篩選結果即時統計。</p>
            </div>
            <div class="orders-stats-grid">
              <article class="orders-stat-item">
                <p class="orders-stat-label">總筆數</p>
                <p id="orders-stat-total" class="orders-stat-value">0</p>
              </article>
              <article class="orders-stat-item">
                <p class="orders-stat-label">總數量</p>
                <p id="orders-stat-qty" class="orders-stat-value">0</p>
              </article>
              <article class="orders-stat-item">
                <p class="orders-stat-label">未完成</p>
                <p id="orders-stat-unfinished" class="orders-stat-value">0</p>
              </article>
              <article class="orders-stat-item">
                <p class="orders-stat-label">未確認</p>
                <p id="orders-stat-unconfirmed" class="orders-stat-value">0</p>
              </article>
            </div>
          </section>

          <details id="orders-filter-disclosure" class="compact-card orders-filter-card">
            <summary>
              <span>進階篩選</span>
              <span id="orders-filter-summary" class="hint">目前未套用進階條件</span>
            </summary>
            <div class="orders-filter-body stack">
              <div class="filter-grid orders-filter-grid">
                <label class="orders-filter-field--wide">
                  關鍵字
                  <input id="orders-keyword-filter" type="text" placeholder="姓名 / 手機 / Email / 匯款帳號 / 備註" />
                </label>
                <label>
                  狀態
                  <select id="orders-status-filter"></select>
                </label>
                <label>
                  交易方式
                  <select id="orders-method-filter">
                    <option value="">全部</option>
                    <option value="面交">面交</option>
                    <option value="賣貨便">賣貨便</option>
                  </select>
                </label>
                <label>
                  匯款時間起
                  <input id="orders-transfer-from" type="datetime-local" />
                </label>
                <label>
                  匯款時間迄
                  <input id="orders-transfer-to" type="datetime-local" />
                </label>
                <label>
                  建立日期起
                  <input id="orders-created-from" type="date" />
                </label>
                <label>
                  建立日期迄
                  <input id="orders-created-to" type="date" />
                </label>
                <label>
                  數量最小
                  <input id="orders-qty-min" type="number" min="1" />
                </label>
                <label>
                  數量最大
                  <input id="orders-qty-max" type="number" min="1" />
                </label>
              </div>

              <div class="toolbar orders-filter-actions">
                <label class="inline-check orders-inline-toggle">
                  <input id="orders-unfinished-only" type="checkbox" />
                  只看未完成
                </label>
                <button id="apply-orders-filter-btn" type="button">套用篩選</button>
                <button id="reset-orders-filter-btn" type="button" class="secondary-btn">清除條件</button>
              </div>

              <div class="toolbar orders-preset-toolbar">
                <label>
                  常用篩選
                  <select id="orders-preset-select"></select>
                </label>
                <button id="apply-orders-preset-btn" type="button">套用預設</button>
                <button id="save-orders-preset-btn" type="button" class="secondary-btn">儲存目前條件</button>
                <button id="delete-orders-preset-btn" type="button" class="ghost-btn">刪除預設</button>
              </div>

              <p class="hint">篩選後的結果可直接匯出 CSV。</p>
            </div>
          </details>

          <section class="compact-card orders-bulk-card">
            <div class="orders-bulk-head">
              <h3>批量修改</h3>
              <p class="hint">勾選訂單後，可一次更新多筆訂單內容。</p>
            </div>

            <div class="toolbar orders-bulk-selection">
              <span id="orders-selected-count" class="status-chip">已選 0 筆</span>
              <button id="orders-select-all-btn" type="button" class="ghost-btn">全選目前結果</button>
              <button id="orders-clear-selection-btn" type="button" class="secondary-btn">清空選取</button>
            </div>

            <div class="filter-grid orders-bulk-grid">
              <label>
                批量狀態
                <select id="bulk-status-select"></select>
              </label>
              <label>
                批量交易方式
                <select id="bulk-method-select">
                  <option value="">不變更</option>
                  <option value="面交">面交</option>
                  <option value="賣貨便">賣貨便</option>
                </select>
              </label>
              <label>
                批量數量
                <input id="bulk-quantity-input" type="number" min="1" step="1" placeholder="留空不變更" />
              </label>
              <label>
                批量匯款帳號
                <input id="bulk-transfer-account-input" type="text" placeholder="留空不變更" />
              </label>
              <label>
                批量匯款時間
                <input id="bulk-transfer-time-input" type="datetime-local" />
              </label>
              <label>
                備註模式
                <select id="bulk-note-mode-select">
                  <option value="append">追加到現有備註</option>
                  <option value="replace">覆蓋現有備註</option>
                </select>
              </label>
              <label class="orders-filter-field--wide orders-bulk-note-field">
                批量備註
                <textarea id="bulk-note-input" rows="2" placeholder="留空不變更"></textarea>
              </label>
            </div>

            <div class="toolbar orders-bulk-actions">
              <button id="apply-bulk-update-btn" type="button">套用到已選訂單</button>
            </div>
          </section>

          <p id="orders-message" class="message" aria-live="polite"></p>
          <div class="table-wrap">
            <table class="admin-orders-table">
              <thead id="orders-head"></thead>
              <tbody id="orders-body"></tbody>
            </table>
          </div>
        </section>

        <section id="orders-logs-view" class="stack hidden section-divider">
          <div class="toolbar">
            <label>
              選擇活動
              <select id="logs-campaign-filter"></select>
            </label>
            <button id="reload-logs-btn" type="button">重新整理紀錄</button>
          </div>
          <p id="logs-message" class="message" aria-live="polite"></p>
          <div class="table-wrap">
            <table>
              <thead>
                <tr>
                  <th>訂單 ID</th>
                  <th>原狀態</th>
                  <th>新狀態</th>
                  <th>操作者</th>
                  <th>時間</th>
                </tr>
              </thead>
              <tbody id="status-logs-body"></tbody>
            </table>
          </div>
        </section>
      </section>
    </main>

    <footer class="container footer">
      <a href="./index.html">回前台頁面</a>
    </footer>

    <script type="module" src="./assets/admin-shell.js?v=20260212-3"></script>
  </body>
</html>
